<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Nginx INIT启动脚本 | Zero&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="nginx服务自启动脚本
CentOS/RHEL 5、6系列

脚本内容12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868">
<meta property="og:type" content="article">
<meta property="og:title" content="Nginx INIT启动脚本">
<meta property="og:url" content="http://czero000.github.io/2015/10/21/nginx-init-scripts.html">
<meta property="og:site_name" content="Zero's Blog">
<meta property="og:description" content="nginx服务自启动脚本
CentOS/RHEL 5、6系列

脚本内容12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868">
<meta property="og:updated_time" content="2016-11-17T02:45:08.953Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Nginx INIT启动脚本">
<meta name="twitter:description" content="nginx服务自启动脚本
CentOS/RHEL 5、6系列

脚本内容12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868">
  
    <link rel="alternate" href="/atom.xml" title="Zero&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Zero&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">点滴分享 多彩生活</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://czero000.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-nginx-init-scripts" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/10/21/nginx-init-scripts.html" class="article-date">
  <time datetime="2015-10-21T02:33:09.000Z" itemprop="datePublished">2015-10-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a>►<a class="article-category-link" href="/categories/Web/Nginx/">Nginx</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Nginx INIT启动脚本
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="nginx服务自启动脚本"><a href="#nginx服务自启动脚本" class="headerlink" title="nginx服务自启动脚本"></a>nginx服务自启动脚本</h3><ul>
<li>CentOS/RHEL 5、6系列</li>
</ul>
<p>脚本内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line"># nginx - this script starts and stops the nginx daemin</div><div class="line">#</div><div class="line"># chkconfig:   - 85 15</div><div class="line"># description:  Nginx is an HTTP(S) server, HTTP(S) reverse</div><div class="line">#               proxy and IMAP/POP3 proxy server</div><div class="line"># processname: nginx</div><div class="line"># config:      /usr/local/nginx/conf/nginx.conf</div><div class="line"># pidfile:     /usr/local/nginx/logs/nginx.pid</div><div class="line"></div><div class="line"># Source function library.</div><div class="line">. /etc/rc.d/init.d/functions</div><div class="line"></div><div class="line"># Source networking configuration.</div><div class="line">. /etc/sysconfig/network</div><div class="line"></div><div class="line"># Check that networking is up.</div><div class="line">[ &quot;$NETWORKING&quot; = &quot;no&quot; ] &amp;&amp; exit 0</div><div class="line"></div><div class="line">nginx=&quot;/usr/local/nginx/sbin/nginx&quot;</div><div class="line">prog=$(basename $nginx)</div><div class="line">NGINX_CONF_FILE=&quot;/usr/local/nginx/conf/nginx.conf&quot;</div><div class="line">lockfile=/var/lock/subsys/nginx</div><div class="line">start() &#123;</div><div class="line">    [ -x $nginx ] || exit 5</div><div class="line">    [ -f $NGINX_CONF_FILE ] || exit 6</div><div class="line">    echo -n $&quot;Starting $prog: &quot;</div><div class="line">    daemon $nginx -c $NGINX_CONF_FILE</div><div class="line">    retval=$?</div><div class="line">    echo</div><div class="line">    [ $retval -eq 0 ] &amp;&amp; touch $lockfile</div><div class="line">    return $retval</div><div class="line">&#125;</div><div class="line"></div><div class="line">stop() &#123;</div><div class="line">    echo -n $&quot;Stopping $prog: &quot;</div><div class="line">    killproc $prog -QUIT</div><div class="line">    retval=$?</div><div class="line">    echo</div><div class="line">    [ $retval -eq 0 ] &amp;&amp; rm -f $lockfile</div><div class="line">    return $retval</div><div class="line">&#125;</div><div class="line"></div><div class="line">restart() &#123;</div><div class="line">    configtest || return $?</div><div class="line">    stop</div><div class="line">    start</div><div class="line">&#125;</div><div class="line"></div><div class="line">reload() &#123;</div><div class="line">    configtest || return $?</div><div class="line">    echo -n $&quot;Reloading $prog: &quot;</div><div class="line">    killproc $nginx -HUP</div><div class="line">    RETVAL=$?</div><div class="line">    echo</div><div class="line">&#125;</div><div class="line"></div><div class="line">force_reload() &#123;</div><div class="line">    restart</div><div class="line">&#125;</div><div class="line"></div><div class="line">configtest() &#123;</div><div class="line">  $nginx -t -c $NGINX_CONF_FILE</div><div class="line">&#125;</div><div class="line"></div><div class="line">rh_status() &#123;</div><div class="line">    status $prog</div><div class="line">&#125;</div><div class="line"></div><div class="line">rh_status_q() &#123;</div><div class="line">    rh_status &gt;/dev/null 2&gt;&amp;1</div><div class="line">&#125;</div><div class="line"></div><div class="line">case &quot;$1&quot; in</div><div class="line">    start)</div><div class="line">        rh_status_q &amp;&amp; exit 0</div><div class="line">        $1</div><div class="line">        ;;</div><div class="line">    stop)</div><div class="line">        rh_status_q || exit 0</div><div class="line">        $1</div><div class="line">        ;;</div><div class="line">    restart|configtest)</div><div class="line">        $1</div><div class="line">        ;;</div><div class="line">    reload)</div><div class="line">        rh_status_q || exit 7</div><div class="line">        $1</div><div class="line">        ;;</div><div class="line">    force-reload)</div><div class="line">        force_reload</div><div class="line">        ;;</div><div class="line">    status)</div><div class="line">        rh_status</div><div class="line">        ;;</div><div class="line">    condrestart|try-restart)</div><div class="line">        rh_status_q || exit 0</div><div class="line">            ;;</div><div class="line">    *)</div><div class="line">        echo $&quot;Usage: $0 &#123;start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest&#125;&quot;</div><div class="line">        exit 2</div><div class="line">esac</div></pre></td></tr></table></figure></p>
<p>在Centos7 或者 相应的Ubuntu版本中添加如下内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">vim /lib/systemd/system/nginx.service   </div><div class="line">[Unit]  </div><div class="line">Description=nginx  </div><div class="line">After=network.target  </div><div class="line"></div><div class="line">[Service]  </div><div class="line">Type=forking  </div><div class="line">ExecStart=/etc/init.d/nginx start  </div><div class="line">ExecReload=/etc/init.d/nginx restart  </div><div class="line">ExecStop=/etc/init.d/nginx  stop  </div><div class="line">PrivateTmp=true  </div><div class="line"></div><div class="line">[Install]  </div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"># Stop dance for nginx</div><div class="line"># =======================</div><div class="line">#</div><div class="line"># ExecStop sends SIGSTOP (graceful stop) to the nginx process.</div><div class="line"># If, after 5s (--retry QUIT/5) nginx is still running, systemd takes control</div><div class="line"># and sends SIGTERM (fast shutdown) to the main process.</div><div class="line"># After another 5s (TimeoutStopSec=5), and if nginx is alive, systemd sends</div><div class="line"># SIGKILL to all the remaining processes in the process group (KillMode=mixed).</div><div class="line">#</div><div class="line"># nginx signals reference doc:</div><div class="line"># http://nginx.org/en/docs/control.html</div><div class="line">#</div><div class="line">[Unit]</div><div class="line">Description=A high performance web server and a reverse proxy server</div><div class="line">After=network.target</div><div class="line"></div><div class="line">[Service]</div><div class="line">Type=forking</div><div class="line">PIDFile=/usr/local/nginx/logs/nginx.pid</div><div class="line">ExecStartPre=/usr/local/nginx/sbin/nginx -t -q -g &apos;daemon on; master_process on;&apos;</div><div class="line">ExecStart=/usr/local/nginx/sbin/nginx -g &apos;daemon on; master_process on;&apos;</div><div class="line">ExecReload=/usr/local/nginx/sbin/nginx -g &apos;daemon on; master_process on;&apos; -s reload</div><div class="line">ExecStop=-/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /usr/local/nginx/logs/nginx.pid</div><div class="line">TimeoutStopSec=5</div><div class="line">KillMode=mixed</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure>
<ul>
<li>Ubuntu</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div></pre></td><td class="code"><pre><div class="line">#! /bin/sh</div><div class="line">### BEGIN INIT INFO</div><div class="line"># Provides:          nginx</div><div class="line"># Required-Start:    $remote_fs $syslog</div><div class="line"># Required-Stop:     $remote_fs $syslog</div><div class="line"># Default-Start:     2 3 4 5</div><div class="line"># Default-Stop:      0 1 6</div><div class="line"># Short-Description: nginx init.d dash script for Ubuntu or other *nix.</div><div class="line"># Description:       nginx init.d dash script for Ubuntu or other *nix.</div><div class="line">### END INIT INFO        </div><div class="line">#------------------------------------------------------------------------------</div><div class="line"># nginx - this Debian Almquist shell (dash) script, starts and stops the nginx</div><div class="line">#         daemon for Ubuntu and other *nix releases.</div><div class="line">#</div><div class="line"># description:  Nginx is an HTTP(S) server, HTTP(S) reverse \</div><div class="line">#               proxy and IMAP/POP3 proxy server.  This \</div><div class="line">#               script will manage the initiation of the \</div><div class="line">#               server and it&apos;s process state.</div><div class="line">#</div><div class="line"># processname: nginx</div><div class="line"># config:      /usr/local/nginx/conf/nginx.conf</div><div class="line"># pidfile:     /usr/local/nginx/logs/nginx.pid</div><div class="line"># Provides:    nginx</div><div class="line">#</div><div class="line"># Author:  Jason Giedymin</div><div class="line">#          &lt;jason.giedymin AT gmail.com&gt;.</div><div class="line">#</div><div class="line"># Version: 3.5.1 11-NOV-2013 jason.giedymin AT gmail.com</div><div class="line"># Notes: nginx init.d dash script for Ubuntu.</div><div class="line"># Tested with: Ubuntu 13.10, nginx-1.4.3</div><div class="line">#</div><div class="line"># This script&apos;s project home is:</div><div class="line">#   [url]http://github.com/JasonGiedymin/nginx-init-ubuntu[/url]</div><div class="line">#</div><div class="line">#------------------------------------------------------------------------------</div><div class="line">#                               MIT X11 License</div><div class="line">#------------------------------------------------------------------------------</div><div class="line">#</div><div class="line"># Copyright (c) 2008-2013 Jason Giedymin, [url]http://jasongiedymin.com[/url]</div><div class="line">#</div><div class="line"># Permission is hereby granted, free of charge, to any person obtaining</div><div class="line"># a copy of this software and associated documentation files (the</div><div class="line"># &quot;Software&quot;), to deal in the Software without restriction, including</div><div class="line"># without limitation the rights to use, copy, modify, merge, publish,</div><div class="line"># distribute, sublicense, and/or sell copies of the Software, and to</div><div class="line"># permit persons to whom the Software is furnished to do so, subject to</div><div class="line"># the following conditions:</div><div class="line">#</div><div class="line"># The above copyright notice and this permission notice shall be</div><div class="line"># included in all copies or substantial portions of the Software.</div><div class="line">#</div><div class="line"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,</div><div class="line"># EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</div><div class="line"># MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND</div><div class="line"># NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE</div><div class="line"># LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION</div><div class="line"># OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION</div><div class="line"># WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</div><div class="line"></div><div class="line">#------------------------------------------------------------------------------</div><div class="line">#------------------------------------------------------------------------------</div><div class="line">#                               Functions</div><div class="line">#------------------------------------------------------------------------------</div><div class="line"></div><div class="line">LSB_FUNC=/lib/lsb/init-functions</div><div class="line"># Test that init functions exists</div><div class="line">test -r $LSB_FUNC || &#123;</div><div class="line">    echo &quot;$0: Cannot find $LSB_FUNC! Script exiting.&quot; 1&gt;&amp;2</div><div class="line">    exit 5</div><div class="line">&#125;</div><div class="line"></div><div class="line">. $LSB_FUNC</div><div class="line">#------------------------------------------------------------------------------</div><div class="line">#                               Consts</div><div class="line">#------------------------------------------------------------------------------</div><div class="line">PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</div><div class="line">DAEMON=/usr/local/nginx/sbin/nginx</div><div class="line"></div><div class="line">PS=&quot;nginx&quot;</div><div class="line">PIDNAME=&quot;nginx&quot;                     #lets you do $PS-slave</div><div class="line">PIDFILE=$PIDNAME.pid                #pid file</div><div class="line">PIDSPATH=/usr/local/nginx/logs      #default pid location, you should change it</div><div class="line">DESCRIPTION=&quot;Nginx Server...&quot;</div><div class="line">RUNAS=root                          #user to run as</div><div class="line">SCRIPT_OK=0                         #ala error codes</div><div class="line">SCRIPT_ERROR=1                      #ala error codes</div><div class="line">TRUE=1                              #boolean</div><div class="line">FALSE=0                             #boolean</div><div class="line"></div><div class="line">lockfile=/var/lock/subsys/nginx</div><div class="line">NGINX_CONF_FILE=&quot;/usr/local/nginx/conf/nginx.conf&quot;</div><div class="line">#------------------------------------------------------------------------------</div><div class="line">#                               Simple Tests</div><div class="line">#------------------------------------------------------------------------------</div><div class="line"></div><div class="line"># Test if nginx is a file and executable</div><div class="line">test -x $DAEMON || &#123;</div><div class="line">    echo &quot;$0: You don&apos;t have permissions to execute nginx.&quot; 1&gt;&amp;2</div><div class="line">    exit 4</div><div class="line">&#125;</div><div class="line"></div><div class="line"># Include nginx defaults if available</div><div class="line">if [ -f /etc/default/nginx ]; then</div><div class="line">    . /etc/default/nginx</div><div class="line">fi</div><div class="line"></div><div class="line">#set exit condition</div><div class="line">#set -e</div><div class="line">#------------------------------------------------------------------------------</div><div class="line">#                               Functions</div><div class="line">#------------------------------------------------------------------------------</div><div class="line">setFilePerms()&#123;</div><div class="line">    if [ -f $PIDSPATH/$PIDFILE ]; then</div><div class="line">        chmod 400 $PIDSPATH/$PIDFILE</div><div class="line">    fi</div><div class="line">&#125;</div><div class="line"></div><div class="line">configtest() &#123;</div><div class="line">    $DAEMON -t -c $NGINX_CONF_FILE</div><div class="line">&#125;</div><div class="line"></div><div class="line">getPSCount() &#123;</div><div class="line">    return `pgrep -f $PS | wc -l`</div><div class="line">&#125;</div><div class="line"></div><div class="line">isRunning() &#123;</div><div class="line">    if [ $1 ]; then</div><div class="line">        pidof_daemon $1</div><div class="line">        PID=$?</div><div class="line">        if [ $PID -gt 0 ]; then</div><div class="line">            return 1</div><div class="line">        else</div><div class="line">            return 0</div><div class="line">        fi</div><div class="line">    else</div><div class="line">        pidof_daemon</div><div class="line">        PID=$?</div><div class="line"></div><div class="line">        if [ $PID -gt 0 ]; then</div><div class="line">            return 1</div><div class="line">        else</div><div class="line">            return 0</div><div class="line">        fi</div><div class="line">    fi</div><div class="line">&#125;         </div><div class="line"></div><div class="line">#courtesy of php-fpm</div><div class="line">wait_for_pid () &#123;</div><div class="line">    try=0         </div><div class="line">    while test $try -lt 35 ; do</div><div class="line">        case &quot;$1&quot; in</div><div class="line">            &apos;created&apos;)</div><div class="line">            if [ -f &quot;$2&quot; ]; then</div><div class="line">                try=&apos;&apos;</div><div class="line">                break</div><div class="line">            fi</div><div class="line">            ;;</div><div class="line"></div><div class="line">            &apos;removed&apos;)</div><div class="line">            if [ ! -f &quot;$2&quot; ]; then</div><div class="line">                try=&apos;&apos;</div><div class="line">                break</div><div class="line">            fi</div><div class="line">            ;;</div><div class="line">        esac</div><div class="line">        try=`expr $try + 1`</div><div class="line">        sleep 1</div><div class="line">    done</div><div class="line">&#125;</div><div class="line"></div><div class="line">status()&#123;</div><div class="line">    isRunning</div><div class="line">    isAlive=$?</div><div class="line"></div><div class="line">    if [ &quot;$&#123;isAlive&#125;&quot; -eq $TRUE ]; then</div><div class="line">        log_warning_msg &quot;$DESCRIPTION found running with processes:  `pidof $PS`&quot;</div><div class="line">        rc=0</div><div class="line">    else</div><div class="line">        log_warning_msg &quot;$DESCRIPTION is NOT running.&quot;</div><div class="line">        rc=3</div><div class="line">    fi</div><div class="line">    return</div><div class="line">&#125;</div><div class="line"></div><div class="line">removePIDFile()&#123;</div><div class="line">    if [ $1 ]; then</div><div class="line">        if [ -f $1 ]; then</div><div class="line">            rm -f $1</div><div class="line">        fi</div><div class="line">    else</div><div class="line">        #Do default removal</div><div class="line">        if [ -f $PIDSPATH/$PIDFILE ]; then</div><div class="line">            rm -f $PIDSPATH/$PIDFILE</div><div class="line">        fi</div><div class="line">    fi</div><div class="line">&#125;</div><div class="line"></div><div class="line">start() &#123;</div><div class="line">    log_daemon_msg &quot;Starting $DESCRIPTION&quot;</div><div class="line">    isRunning</div><div class="line">    isAlive=$?</div><div class="line">    if [ &quot;$&#123;isAlive&#125;&quot; -eq $TRUE ]; then</div><div class="line">        log_end_msg $SCRIPT_ERROR</div><div class="line">        rc=0</div><div class="line">     else</div><div class="line">        start-stop-daemon --start --quiet --chuid \</div><div class="line">        $RUNAS --pidfile $PIDSPATH/$PIDFILE --exec $DAEMON \</div><div class="line">        -- -c $NGINX_CONF_FILE</div><div class="line">        setFilePerms</div><div class="line">        log_end_msg $SCRIPT_OK</div><div class="line">        rc=0</div><div class="line">    fi</div><div class="line"></div><div class="line">    return</div><div class="line">&#125;</div><div class="line"></div><div class="line">stop() &#123;</div><div class="line">    log_daemon_msg &quot;Stopping $DESCRIPTION&quot;</div><div class="line">    isRunning</div><div class="line">    isAlive=$?</div><div class="line">    if [ &quot;$&#123;isAlive&#125;&quot; -eq $TRUE ]; then</div><div class="line">        start-stop-daemon --stop --quiet --pidfile $PIDSPATH/$PIDFILE</div><div class="line">        wait_for_pid &apos;removed&apos; $PIDSPATH/$PIDFILE</div><div class="line"></div><div class="line">        if [ -n &quot;$try&quot; ]; then</div><div class="line">            log_end_msg $SCRIPT_ERROR</div><div class="line">            rc=0 # lsb states 1, but under status it is 2 (which is more prescriptive). Deferring to standard.</div><div class="line">        else</div><div class="line">            removePIDFile</div><div class="line">            log_end_msg $SCRIPT_OK</div><div class="line">            rc=0</div><div class="line">        fi</div><div class="line">    else</div><div class="line">        log_end_msg $SCRIPT_ERROR</div><div class="line">        rc=7</div><div class="line">    fi</div><div class="line"></div><div class="line">    return</div><div class="line">&#125;</div><div class="line"></div><div class="line">reload() &#123;</div><div class="line">    configtest || return $?</div><div class="line">    log_daemon_msg &quot;Reloading (via HUP) $DESCRIPTION&quot;</div><div class="line">    isRunning</div><div class="line">    if [ $? -eq $TRUE ]; then</div><div class="line">        kill -HUP `cat $PIDSPATH/$PIDFILE`</div><div class="line">        log_end_msg $SCRIPT_OK</div><div class="line">        rc=0</div><div class="line">    else</div><div class="line">        log_end_msg $SCRIPT_ERROR</div><div class="line">        rc=7</div><div class="line">    fi</div><div class="line">    return</div><div class="line">&#125;</div><div class="line"></div><div class="line">quietupgrade() &#123;</div><div class="line">    log_daemon_msg &quot;Peforming Quiet Upgrade $DESCRIPTION&quot;</div><div class="line">    isRunning</div><div class="line">    isAlive=$?</div><div class="line">    if [ &quot;$&#123;isAlive&#125;&quot; -eq $TRUE ]; then</div><div class="line">        kill -USR2 `cat $PIDSPATH/$PIDFILE`</div><div class="line">        kill -WINCH `cat $PIDSPATH/$PIDFILE.oldbin`</div><div class="line">        isRunning</div><div class="line">        isAlive=$?</div><div class="line">        if [ &quot;$&#123;isAlive&#125;&quot; -eq $TRUE ]; then</div><div class="line">            kill -QUIT `cat $PIDSPATH/$PIDFILE.oldbin`</div><div class="line">            wait_for_pid &apos;removed&apos; $PIDSPATH/$PIDFILE.oldbin</div><div class="line">            removePIDFile $PIDSPATH/$PIDFILE.oldbin</div><div class="line">            log_end_msg $SCRIPT_OK</div><div class="line">            rc=0</div><div class="line">        else</div><div class="line">            log_end_msg $SCRIPT_ERROR</div><div class="line">            log_daemon_msg &quot;ERROR! Reverting back to original $DESCRIPTION&quot;</div><div class="line">            kill -HUP `cat $PIDSPATH/$PIDFILE`</div><div class="line">            kill -TERM `cat $PIDSPATH/$PIDFILE.oldbin`</div><div class="line">            kill -QUIT `cat $PIDSPATH/$PIDFILE.oldbin`</div><div class="line">            wait_for_pid &apos;removed&apos; $PIDSPATH/$PIDFILE.oldbin</div><div class="line">            removePIDFile $PIDSPATH/$PIDFILE.oldbin</div><div class="line">            log_end_msg $SCRIPT_OK</div><div class="line">            rc=0</div><div class="line">        fi</div><div class="line">    else</div><div class="line">        log_end_msg $SCRIPT_ERROR</div><div class="line">        rc=7</div><div class="line">    fi</div><div class="line">    return</div><div class="line">&#125;</div><div class="line"></div><div class="line">terminate() &#123;</div><div class="line">    log_daemon_msg &quot;Force terminating (via KILL) $DESCRIPTION&quot;</div><div class="line">    PIDS=`pidof $PS` || true</div><div class="line">    [ -e $PIDSPATH/$PIDFILE ] &amp;&amp; PIDS2=`cat $PIDSPATH/$PIDFILE`</div><div class="line">    for i in $PIDS; do</div><div class="line">        if [ &quot;$i&quot; = &quot;$PIDS2&quot; ]; then</div><div class="line">            kill $i</div><div class="line">            wait_for_pid &apos;removed&apos; $PIDSPATH/$PIDFILE</div><div class="line">            removePIDFile</div><div class="line">        fi</div><div class="line">    done</div><div class="line">    log_end_msg $SCRIPT_OK</div><div class="line">    rc=0</div><div class="line">&#125;</div><div class="line"></div><div class="line">destroy() &#123;</div><div class="line">    log_daemon_msg &quot;Force terminating and may include self (via KILLALL) $DESCRIPTION&quot;</div><div class="line">    killall $PS -q &gt;&gt; /dev/null 2&gt;&amp;1</div><div class="line">    log_end_msg $SCRIPT_OK</div><div class="line">    rc=0</div><div class="line">&#125;</div><div class="line"></div><div class="line">pidof_daemon() &#123;</div><div class="line">    PIDS=`pidof $PS` || true</div><div class="line">    [ -e $PIDSPATH/$PIDFILE ] &amp;&amp; PIDS2=`cat $PIDSPATH/$PIDFILE`</div><div class="line"></div><div class="line">    for i in $PIDS; do</div><div class="line">        if [ &quot;$i&quot; = &quot;$PIDS2&quot; ]; then</div><div class="line">            return 1</div><div class="line">        fi</div><div class="line">    done</div><div class="line">    return 0</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">action=&quot;$1&quot;</div><div class="line">case &quot;$1&quot; in</div><div class="line">    start)</div><div class="line">        start</div><div class="line">        ;;</div><div class="line">    stop)</div><div class="line">        stop</div><div class="line">        ;;</div><div class="line">    restart|force-reload)</div><div class="line">        stop</div><div class="line">        # if [ $rc -ne 0 ]; then</div><div class="line">        #     script_exit</div><div class="line">        # fi</div><div class="line">        sleep 1</div><div class="line">        start</div><div class="line">        ;;</div><div class="line">    reload)</div><div class="line">        $1</div><div class="line">        ;;</div><div class="line">    status)</div><div class="line">        status</div><div class="line">        ;;</div><div class="line">    configtest)</div><div class="line">        $1</div><div class="line">        ;;</div><div class="line">    quietupgrade)</div><div class="line">        $1</div><div class="line">        ;;</div><div class="line">    terminate)</div><div class="line">        $1</div><div class="line">        ;;</div><div class="line">    destroy)</div><div class="line">        $1</div><div class="line">        ;;</div><div class="line">    *)</div><div class="line">        FULLPATH=/etc/init.d/$PS</div><div class="line">        echo &quot;Usage: $FULLPATH &#123;start|stop|restart|force-reload|status|configtest|quietupgrade|terminate|destroy&#125;&quot;</div><div class="line">        echo &quot;       The &apos;destroy&apos; command should only be used as a last resort.&quot;</div><div class="line">        exit 3</div><div class="line">        ;;</div><div class="line">esac</div><div class="line">exit $rc</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://czero000.github.io/2015/10/21/nginx-init-scripts.html" data-id="civlr7zfb0000935mdpx2kaoc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nginx/">nginx</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/10/21/vim-nginx-hight-light.html" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Nginx代码高亮
        
      </div>
    </a>
  
  
    <a href="/2015/10/19/install-bind-ms.html" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Centos6配置主辅DNS</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Blog/">Blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Database/">Database</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Database/MySQL/">MySQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Database/Redis/">Redis</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Markdown/">Markdown</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/">System</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/System/Bash/">Bash</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/CentOS/">CentOS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/Command/">Command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/DNS/">DNS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/Debian/">Debian</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/Git/">Git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/Gitlab/">Gitlab</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/IPTABLES/">IPTABLES</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/L2TP/">L2TP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/Monitor/">Monitor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/NFS/">NFS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/Other/">Other</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/Proxy/">Proxy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/RRDTOOL/">RRDTOOL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/System/Security/">Security</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Web/Apache/">Apache</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/Nginx/">Nginx</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/虚拟化/">虚拟化</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/虚拟化/KVM/">KVM</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/运维技术/">运维技术</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/运维技术/Docker/">Docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/运维技术/ELK/">ELK</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/运维技术/GlusterFS/">GlusterFS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/运维技术/MooseFS/">MooseFS</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/运维自动化/">运维自动化</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/运维自动化/Ansible/">Ansible</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/运维自动化/Cobbler/">Cobbler</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/运维自动化/SaltStack/">SaltStack</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Blog/">Blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP状态码/">HTTP状态码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MooseFS/">MooseFS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ansible/">ansible</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/apache/">apache</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/awk/">awk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bash/">bash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bind/">bind</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cacti/">cacti</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/centos/">centos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chinese/">chinese</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chromium/">chromium</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cobbler/">cobbler</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/curl/">curl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/debian/">debian</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/download/">download</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dropbox/">dropbox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsearch/">elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsearch-elk/">elasticsearch.elk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elk/">elk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/em1/">em1</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/epel/">epel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eth0/">eth0</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fishshell/">fishshell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitlab/">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitolite/">gitolite</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/glances/">glances</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/glibc/">glibc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/glusterfs/">glusterfs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gpt/">gpt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/https/">https</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iftop/">iftop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/inotify/">inotify</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iptables/">iptables</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kernel/">kernel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kibana/">kibana</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kvm/">kvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/l2tp/">l2tp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/logrotate/">logrotate</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/logstash/">logstash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/logstash-forwarder/">logstash-forwarder</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdown/">markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/megacli/">megacli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mindmap/">mindmap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/monitor/">monitor</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mycli/">mycli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nfs/">nfs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx-vim/">nginx.vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ntp/">ntp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openssl/">openssl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/parted/">parted</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/passwd/">passwd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php-fpm/">php-fpm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pptp/">pptp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/proxy/">proxy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/raid/">raid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rrdtool/">rrdtool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rsync/">rsync</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/saltstack/">saltstack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/security/">security</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/servicewrapper/">servicewrapper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shadowsocks/">shadowsocks</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/smokeping/">smokeping</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/socks5/">socks5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ss5/">ss5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/transmission/">transmission</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/virsh/">virsh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vncserver/">vncserver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xz/">xz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/yum/">yum</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zsh/">zsh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/书写指南/">书写指南</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Blog/" style="font-size: 10px;">Blog</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/HTTP状态码/" style="font-size: 10px;">HTTP状态码</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/MooseFS/" style="font-size: 10px;">MooseFS</a> <a href="/tags/ansible/" style="font-size: 17.5px;">ansible</a> <a href="/tags/apache/" style="font-size: 10px;">apache</a> <a href="/tags/awk/" style="font-size: 11.25px;">awk</a> <a href="/tags/bash/" style="font-size: 18.75px;">bash</a> <a href="/tags/bind/" style="font-size: 11.25px;">bind</a> <a href="/tags/cacti/" style="font-size: 10px;">cacti</a> <a href="/tags/centos/" style="font-size: 12.5px;">centos</a> <a href="/tags/chinese/" style="font-size: 11.25px;">chinese</a> <a href="/tags/chromium/" style="font-size: 10px;">chromium</a> <a href="/tags/cobbler/" style="font-size: 11.25px;">cobbler</a> <a href="/tags/curl/" style="font-size: 10px;">curl</a> <a href="/tags/debian/" style="font-size: 10px;">debian</a> <a href="/tags/docker/" style="font-size: 12.5px;">docker</a> <a href="/tags/download/" style="font-size: 10px;">download</a> <a href="/tags/dropbox/" style="font-size: 10px;">dropbox</a> <a href="/tags/elasticsearch/" style="font-size: 10px;">elasticsearch</a> <a href="/tags/elasticsearch-elk/" style="font-size: 10px;">elasticsearch.elk</a> <a href="/tags/elk/" style="font-size: 12.5px;">elk</a> <a href="/tags/em1/" style="font-size: 10px;">em1</a> <a href="/tags/epel/" style="font-size: 10px;">epel</a> <a href="/tags/eth0/" style="font-size: 10px;">eth0</a> <a href="/tags/fishshell/" style="font-size: 10px;">fishshell</a> <a href="/tags/git/" style="font-size: 13.75px;">git</a> <a href="/tags/gitlab/" style="font-size: 10px;">gitlab</a> <a href="/tags/gitolite/" style="font-size: 10px;">gitolite</a> <a href="/tags/glances/" style="font-size: 10px;">glances</a> <a href="/tags/glibc/" style="font-size: 10px;">glibc</a> <a href="/tags/glusterfs/" style="font-size: 12.5px;">glusterfs</a> <a href="/tags/gpt/" style="font-size: 10px;">gpt</a> <a href="/tags/https/" style="font-size: 10px;">https</a> <a href="/tags/iftop/" style="font-size: 10px;">iftop</a> <a href="/tags/inotify/" style="font-size: 11.25px;">inotify</a> <a href="/tags/iptables/" style="font-size: 10px;">iptables</a> <a href="/tags/kernel/" style="font-size: 10px;">kernel</a> <a href="/tags/kibana/" style="font-size: 10px;">kibana</a> <a href="/tags/kvm/" style="font-size: 10px;">kvm</a> <a href="/tags/l2tp/" style="font-size: 10px;">l2tp</a> <a href="/tags/logrotate/" style="font-size: 10px;">logrotate</a> <a href="/tags/logstash/" style="font-size: 11.25px;">logstash</a> <a href="/tags/logstash-forwarder/" style="font-size: 10px;">logstash-forwarder</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/megacli/" style="font-size: 11.25px;">megacli</a> <a href="/tags/mindmap/" style="font-size: 11.25px;">mindmap</a> <a href="/tags/monitor/" style="font-size: 15px;">monitor</a> <a href="/tags/mycli/" style="font-size: 10px;">mycli</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/nfs/" style="font-size: 10px;">nfs</a> <a href="/tags/nginx/" style="font-size: 20px;">nginx</a> <a href="/tags/nginx-vim/" style="font-size: 10px;">nginx.vim</a> <a href="/tags/ntp/" style="font-size: 10px;">ntp</a> <a href="/tags/openssl/" style="font-size: 10px;">openssl</a> <a href="/tags/parted/" style="font-size: 10px;">parted</a> <a href="/tags/passwd/" style="font-size: 10px;">passwd</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/php-fpm/" style="font-size: 10px;">php-fpm</a> <a href="/tags/pptp/" style="font-size: 11.25px;">pptp</a> <a href="/tags/proxy/" style="font-size: 15px;">proxy</a> <a href="/tags/python/" style="font-size: 12.5px;">python</a> <a href="/tags/raid/" style="font-size: 10px;">raid</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/rrdtool/" style="font-size: 10px;">rrdtool</a> <a href="/tags/rsync/" style="font-size: 10px;">rsync</a> <a href="/tags/saltstack/" style="font-size: 16.25px;">saltstack</a> <a href="/tags/security/" style="font-size: 10px;">security</a> <a href="/tags/servicewrapper/" style="font-size: 10px;">servicewrapper</a> <a href="/tags/shadowsocks/" style="font-size: 10px;">shadowsocks</a> <a href="/tags/smokeping/" style="font-size: 13.75px;">smokeping</a> <a href="/tags/socks5/" style="font-size: 11.25px;">socks5</a> <a href="/tags/ss5/" style="font-size: 10px;">ss5</a> <a href="/tags/transmission/" style="font-size: 10px;">transmission</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/virsh/" style="font-size: 10px;">virsh</a> <a href="/tags/vncserver/" style="font-size: 10px;">vncserver</a> <a href="/tags/xz/" style="font-size: 10px;">xz</a> <a href="/tags/yum/" style="font-size: 10px;">yum</a> <a href="/tags/zsh/" style="font-size: 10px;">zsh</a> <a href="/tags/书写指南/" style="font-size: 10px;">书写指南</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/11/17/Git-basic.html">Git基础</a>
          </li>
        
          <li>
            <a href="/2016/10/26/ansible-managment-windows.html">使用ansible管理windows主机</a>
          </li>
        
          <li>
            <a href="/2016/10/20/git-different-sshkey.html">配置不同ssh-key访问不同git仓库</a>
          </li>
        
          <li>
            <a href="/2016/10/20/l2tp-vpn.html">IPsec和L2TP搭建VPN</a>
          </li>
        
          <li>
            <a href="/2016/10/20/ansible-dynamic-create-vhost.html">通过jinja2生成虚拟主机配置</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 C.c<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>